Copied from the TOTP extension in Firefox
